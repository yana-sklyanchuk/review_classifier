# [Анализ отзывов о ресторане](EDA_report.ipynb)

## Назначение

Данный документ содержит анализ отзывов о ресторане. Отражает выводы, полученные в результате:
- ознакомления с данными;
- EDA. Включает в себя предобработку данных и генерацию новых признаков.

### Необходимые файлы
json-файл: restaurant_reviews.json - Этот файл содержит отзывы о ресторанах и соответствующие им настроения (положительные или отрицательные).

содержит: 1000 текстовых записей на английском языке, 2 категории отзывов: позитивные или негативные.

Колонки:
- review - содержит отзыв в виде текста;
- liked - содержит; 0 - позитивный отзыв, 1 - негативный отзыв.

### Выводы
- Ознакомление с данными позволило выявить наличие 4 дубликатов. Дубликаты были удалены. Соотношение категориальных признаков практически равное. Отсутствует дисбаланс.
- EDA позволил выявить следующее: для распределения количества слов в отзывах характерны близкие значения среднего, как для негативных, так и для позитивных: около 10 слов. Можно отметить, что позитивные отзывы могут быть более лаконичными, а негативные - чуть более развернутыми;
- была проведена очистка текста: удаления лишних символов и чисел, приведения к нижнему регистру, удаления стоп-слов, проведения токенизации и лематизации. Анализ распределения частоты слов в отзывах позволил выделить ключевые слова, которые чаще встречаются в отзывах: food, place, good, service, great, back. Из них можно сделать вывод, что потребители считают значимыми: качество еды, интерьер заведение и качество сервиса. Анализ распределения частоты слов в зависимости от тональности отзыва показал схожие наборы слов, что потребовало определения уникальных слов, характерных для каждого вида отзывов.



# [Инструмент для визуализации наиболее частых слов в позитивных и негативных отзывах](generate_word_cloud.ipynb)

## Назначение
Этот сценарий обеспечивает визуальное представление чувств, выраженных в отзывах о ресторанах, позволяя быстро и интуитивно понять наиболее часто упоминаемые слова как в положительном, так и в отрицательном контексте. Использование маски повышает эстетическую привлекательность облаков слов, делая их более интересными для презентаций или докладов.

## Необходимые файлы
json-файл: restaurant_reviews.json - Этот файл содержит отзывы о ресторанах и соответствующие им настроения (положительные или отрицательные).
Изображение маски: comment.png - черно-белое изображение, используемое в качестве маски для формы облака слов (в данном случае в виде комментария).

## Вывод
Скрипт выводит два облака слов:
- Положительные отзывы: Облако слов, представляющее наиболее часто встречающиеся слова в положительных отзывах, в форме комментария.
- Отрицательные отзывы: Облако слов, представляющее наиболее часто встречающиеся слова в отрицательных отзывах, также в форме комментария.

# [Модель для классификации отзывов о ресторане](model_restaurant_reviews.ipynb)

## Назначение
Проект направлен на разработку модели машинного обучения для классификации отзывов о ресторанах: положительных или отрицательных. Модель обучается на наборе данных отзывов о ресторанах и соответствующих им метках настроения. Проект включает в себя предварительную обработку данных, обучение модели и оценку.

## Этапы обучения
### Предварительная обработка данных
- Загрузка набора данных из JSON-файла в pandas DataFrame.
- Очиститка и предварительная обработка текста отзывов, преобразование его в строчные буквы, удаление URL-адреса, HTML-теги, знаков препинания и цифровых символов.
- Разделение набора данных на обучающий и тестовый наборы с помощью функции train_test_split от scikit-learn, обеспечивает стратифицированное разбиение на основе целевого столбца.
- Преобразование обучающего и тестового набора в Hugging Face Datasets.
- Токенизация текста отзыва с помощью токенизатора DistilBERT, обрезка и разбиение последовательности до максимальной длины в 32 токена.
- Добавление метки настроения в виде тензоров к токенизированным данным.
### Обучение модели
- Загрузка предварительно обученной модели DistilBERT для классификации последовательностей, указание количества меток и сопоставление метки с идентификаторами.
- Определение аргументов обучения, включая выходной каталог, количество эпох, скорость обучения, размер партии, затухание веса и стратегию оценки.
- Создание объекта Trainer, передача ему модели, аргументов для обучения, коллатор данных, наборы данных для обучения и оценки, а также функцию вычисления метрик.
- Обучение модели с помощью метода train() объекта Trainer.
- Загрузка обученной модели в Hugging Face с помощью метода push_to_hub().
### Оценка модели
Эффективность модели оценивается с помощью метрики точности. Функция compute_metrics определена для расчета точности на оценочном наборе данных.
## Результаты
### Обученная модель достигла следующих результатов на оценочном наборе данных:
- Loss: 0.2244
- Accuracy: 0.9196
### Процесс обучения занял 3 эпохи со следующими гиперпараметрами:
- Learning rate: 2e-05
- Train batch size: 16
- Eval batch size: 16
- Seed: 42
- Optimizer: Adam with betas=(0.9,0.999) and epsilon=1e-08
- LR scheduler type: linear
- Number of epochs: 3


Потери при обучении и проверке уменьшались с течением эпох, а точность увеличивалась.
### Версии фреймворка
- Transformers: 4.42.4
- PyTorch: 2.3.1+cu121
- Datasets: 2.20.0
- Tokenizers: 0.19.1

## Использование
Чтобы использовать обученную модель для анализа настроений, вы можете загрузить ее с помощью конвейера Hugging Face:
- загрузка среды

```python
from transformers import pipeline

model_name = "yana-sklyanchuk/restaurant_reviews"


access_token = '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'

classifier = pipeline("sentiment-analysis", model=model_name, tokenizer="distilbert-base-uncased",token = access_token )


classifier("Didn't like the food and terrible service")
```
- Ожидаемый ответ

```
[{'label': 'Негативные', 'score': 0.9540563225746155}]
```